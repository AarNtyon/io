<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/1f0d902978992700.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/004d055e2de33bc2.css" data-precedence="next"/><title>聊聊代码格式化</title><meta name="description" content="如果你想让两个程序员吵起来，就只需要问他们 tab 和 space 谁更好"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><body><div id="__next"><div id="app" class="flex h-100% flex-col"><header class="flex justify-between  w-68% h-66px m-auto items-center xs:w-100% p-l-80px p-r-80px xs:p-l-20px xs:p-r-20px shrink-0"><a class="text-20px cursor-pointer font-bold font-mono dark:color-white hover:color-#1e90ff" href="/"><span>Rain&#x27;s Blog</span></a><nav class="flex items-center column-50px"><nav class="text-right opacity-[0.6] text-[16px] dark:color-#e5e7eb flex"><a class="mr-20px" href="/post"><span class="xs:hidden md:block">文章</span><i class="xs:block  md:hidden dark:color-#fff i-carbon-align-box-top-left"></i></a><a class="mr-20px" href="/tags"><span class="xs:hidden md:block">标签</span><i class="xs:block  md:hidden dark:color-#fff i-carbon-bookmark-add"></i></a><a class="mr-20px" href="/about"><span class="xs:hidden md:block">关于</span><i class="xs:block  md:hidden dark:color-#fff i-carbon-sprout"></i></a></nav><!--$!--><template data-dgst="NEXT_DYNAMIC_NO_SSR_CODE"></template><!--/$--></nav></header><main class="font-sans flex-auto"><div class="prose w-60% m-auto m-b-50px xs:w-90% m-t-66px"><div class="m-b-30px"><div><h1>聊聊代码格式化</h1><p class="flex justify-between"><span class="color-gray">Rain, <!-- -->Fri  Mar  24  2023</span><a class="cursor-pointer color-gray" href="/post">back</a></p></div></div><article class="prose"><h2>Tabs VS Spaces</h2>
<p>首先，我想谈谈我关于使用 Tab 还是 Space 的考虑。我毫无疑问地支持使用 Tab。</p>
<p>我的理由是，Tab 能够自由地控制在编辑器中显示的长度；
同时，显然不是所有人对于空格个数的偏好都一致。
既然如此，为什么不使用 Tab 缩进，然后将显示缩进宽度的选择权交给每个人呢？
这样，无论你更喜欢紧凑的代码布局，还是想要增大缩进来尽早发现你代码中的嵌套，都是被允许的。</p>
<p>当然，不是所有软件都允许你动态的调整 Tab 的长度。
如果它被固定到你不喜欢的宽度，可能会引起你的不适。
Space 则没有这个问题。</p>
<h2>Prettier</h2>
<p><a href="https://prettier.io">Prettier</a> 是 Node.js 生态中使用最多的代码格式化工具。
它可以统一你的代码风格，比如缩进、引号、分号等。</p>
<p>以下是我所使用的全部有关 Prettier 的内容。</p>
<h3>设置过程</h3>
<p>安装为开发依赖</p>
<pre class="pre-dark" style="background:#fafafa"><code><span class="line"><span style="color: #61AFEF">ni</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">-D</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">prettier</span></span>
<span class="line"></span></code></pre>
<p>在 <code>package.json</code> 中添加格式化的脚本和配置。</p>
<pre class="pre-dark" style="background:#fafafa"><code><span class="line"><span style="color: #ABB2BF">{</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">&quot;scripts&quot;</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">&quot;format&quot;</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">&quot;prettier --write .&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">  },</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">&quot;prettier&quot;</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">&quot;semi&quot;</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">false</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<p>按需创建 <code>.prettierignore</code> 文件，你可以以 <code>.gitignore</code> 为基础。</p>
<p>安装 <a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier VSCode 插件</a>，添加配置到 <code>.vscode/settings.json</code>。
由于已经配置好 ignore 的规则，我们可以直接设置它为默认格式化器，如有例外的文件类型再自行覆盖。</p>
<pre class="pre-dark" style="background:#fafafa"><code><span class="line"><span style="color: #ABB2BF">{</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">&quot;editor.defaultFormatter&quot;</span><span style="color: #ABB2BF">: </span><span style="color: #98C379">&quot;esbenp.prettier-vscode&quot;</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">&quot;editor.formatOnSave&quot;</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<p>如此，当你保存文件时，prettier 就会自动帮你格式化代码。</p>
<h3>EditorConfig</h3>
<p><a href="https://editorconfig.org">EditorConfig</a> 是一份通用的编辑器配置规范，很多编辑器和工具都支持它的配置项。
取决于你自己，可以设置好一份 <code>.editorconfig</code> 文件，它的配置项会被 Prettier 识别。
安装 <a href="https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig">EditorConfig VSCode 插件</a> 后，也能按配置调整 vscode 的工作区设置。</p>
<pre class="pre-dark" style="background:#fafafa"><code><span class="line"><span style="color: #61AFEF">[*]</span></span>
<span class="line"><span style="color: #C678DD">charset</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> utf-8</span></span>
<span class="line"><span style="color: #C678DD">end_of_line</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> lf</span></span>
<span class="line"><span style="color: #C678DD">max_line_length</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> 80</span></span>
<span class="line"><span style="color: #C678DD">indent_style</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> tab</span></span>
<span class="line"><span style="color: #C678DD">insert_final_newline</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> true</span></span>
<span class="line"><span style="color: #C678DD">trim_trailing_whitespace</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> true</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">[*.{md,yml}]</span></span>
<span class="line"><span style="color: #C678DD">indent_style</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> space</span></span>
<span class="line"><span style="color: #C678DD">indent_size</span><span style="color: #98C379"> </span><span style="color: #ABB2BF">=</span><span style="color: #98C379"> 2</span></span>
<span class="line"></span></code></pre>
<blockquote>
<p>需要注意 windows 和其它系统的换行符不同，为 crlf。</p>
</blockquote>
<h2>Q&amp;A</h2>
<h3>为什么不使用 eslint 来检查代码风格？</h3>
<ol>
<li>要达到 Prettier 的格式化效果，需要配置维护大量的 eslint 规则，且存在不易实现的效果。
<ol>
<li>对于 vue 项目，你可以尝试使用 <code>@antfu/eslint-config</code></li>
</ol>
</li>
<li>代码风格无关代码正确性，eslint 会飘很多红。lint 这个词对于代码风格来说太严格了。
<ol>
<li>虽然可以在保存时自动修复，但我受不了。</li>
</ol>
</li>
</ol>
<p>另外，推荐不要结合 eslint 使用 Prettier，vscode 明明有 lint 和 format 各自对应的设置项。</p>
<h3>为何不配置 Prettier 的配置项和插件？</h3>
<ol>
<li>就默认的配置而言，去除分号后，代码已经足够美观</li>
<li>就我折腾 Prettier 插件的体验来说，只要超过使用一个插件，就很大概率会出现插件冲突的问题
<ol>
<li>我尝试折腾过 <code>@ianvs/prettier-plugin-sort-imports</code> 插件来格式化 import 语句，但它无法处理全部的场景。</li>
<li>我也用过 <code>prettier-plugin-tailwindcss</code> 来排序 tailwind 的 classname。 但是它和前者无法共同使用，还会和 <code>@egoist/tailwindcss-icons</code> 不相容。</li>
</ol>
</li>
</ol>
<h3>如何格式化 import 语句？</h3>
<p>推荐使用 vscode 的设置项，它能实现对 import 进行排序，去除未使用的 import 等功能。</p>
<pre class="pre-dark" style="background:#fafafa"><code><span class="line"><span style="color: #ABB2BF">{</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #E06C75">&quot;editor.codeActionsOnSave&quot;</span><span style="color: #ABB2BF">: {</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #E06C75">&quot;source.organizeImports&quot;</span><span style="color: #ABB2BF">: </span><span style="color: #D19A66">true</span></span>
<span class="line"><span style="color: #ABB2BF">  }</span></span>
<span class="line"><span style="color: #ABB2BF">}</span></span>
<span class="line"></span></code></pre>
<h2>总结</h2>
<p>总之，人生苦短，我懒得弄了。</p>
<p>遇到的问题有的有办法规避或者解决，但是需要花时间去排查，我对此感到疲惫。
所以，我不愿意再去追求完美的效果，可以手动处理这些场景。
对于 Prettier 本体来说，开箱即用的体验挺好的。</p>
<h2>相关链接</h2>
<ol>
<li><a href="https://antfu.me/posts/why-not-prettier">Why I don't use Prettier</a></li>
</ol>
</article></div></main><footer class="dark:color-white text-center h-66px leading-[66px]">© <!-- -->2023<!-- -->, Rain | Powered by Next.js</footer><!--$!--><template data-dgst="NEXT_DYNAMIC_NO_SSR_CODE"></template><!--/$--></div></div><script src="/_next/static/chunks/webpack-b19f63780b4947aa.js" async=""></script><script src="/_next/static/chunks/2443530c-824e93370d7398c3.js" async=""></script><script src="/_next/static/chunks/488-e1ddd61bb847c097.js" async=""></script><script src="/_next/static/chunks/main-app-10ca5663deb765cf.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/1f0d902978992700.css\",{\"as\":\"style\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/004d055e2de33bc2.css\",{\"as\":\"style\"}]\n"])</script><script>self.__next_f.push([1,"4:I{\"id\":\"8827\",\"chunks\":[\"272:static/chunks/webpack-b19f63780b4947aa.js\",\"667:static/chunks/2443530c-824e93370d7398c3.js\",\"488:static/chunks/488-e1ddd61bb847c097.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":\"9126\",\"chunks\":[\"272:static/chunks/webpack-b19f63780b4947aa.js\",\"667:static/chunks/2443530c-824e93370d7398c3.js\",\"488:static/chunks/488-e1ddd61bb847c097.js\"],\"name\":\"\",\"async\":false}\n7:I{\"id\":\"8920\",\"chunks\":[\"920:static/chunks/920-2fb459665447a51a.js\",\"605:static/chunks/app/post/[slug]/page-a215c359bbae8405"])</script><script>self.__next_f.push([1,".js\"],\"name\":\"\",\"async\":false}\n8:\"$Sreact.suspense\"\n9:I{\"id\":\"7069\",\"chunks\":[\"920:static/chunks/920-2fb459665447a51a.js\",\"185:static/chunks/app/layout-cd85c0e929e8f1b3.js\"],\"name\":\"NoSSR\",\"async\":false}\na:I{\"id\":\"5554\",\"chunks\":[\"920:static/chunks/920-2fb459665447a51a.js\",\"185:static/chunks/app/layout-cd85c0e929e8f1b3.js\"],\"name\":\"\",\"async\":false}\nc:I{\"id\":\"2263\",\"chunks\":[\"920:static/chunks/920-2fb459665447a51a.js\",\"185:static/chunks/app/layout-cd85c0e929e8f1b3.js\"],\"name\":\"\",\"async\":false}\nd:I{\"id\":\"4463"])</script><script>self.__next_f.push([1,"\",\"chunks\":[\"272:static/chunks/webpack-b19f63780b4947aa.js\",\"667:static/chunks/2443530c-824e93370d7398c3.js\",\"488:static/chunks/488-e1ddd61bb847c097.js\"],\"name\":\"\",\"async\":false}\ne:I{\"id\":\"1010\",\"chunks\":[\"272:static/chunks/webpack-b19f63780b4947aa.js\",\"667:static/chunks/2443530c-824e93370d7398c3.js\",\"488:static/chunks/488-e1ddd61bb847c097.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1f0d902978992700.css\",\"precedence\":\"next\"}]],[\"$\",\"$L4\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/code-format.md\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"slug\",\"code-format.md\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"code-format.md\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L5\",null],\"globalErrorComponent\":\"$6\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"id\":\"__next\",\"children\":[\"$\",\"div\",null,{\"id\":\"app\",\"className\":\"flex h-100% flex-col\",\"children\":[[\"$\",\"header\",null,{\"className\":\"flex justify-between  w-68% h-66px m-auto items-center xs:w-100% p-l-80px p-r-80px xs:p-l-20px xs:p-r-20px shrink-0\",\"children\":[[\"$\",\"$L7\",null,{\"className\":\"text-20px cursor-pointer font-bold font-mono dark:color-white hover:color-#1e90ff\",\"href\":\"/\",\"children\":[\"$\",\"span\",null,{\"children\":\"Rain's Blog\"}]}],[\"$\",\"nav\",null,{\"className\":\"flex items-center column-50px\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"text-right opacity-[0.6] text-[16px] dark:color-#e5e7eb flex\",\"children\":[[\"$\",\"$L7\",null,{\"className\":\"mr-20px\",\"href\":\"/post\",\"children\":[[\"$\",\"span\",null,{\"className\":\"xs:hidden md:block\",\"children\":\"文章\"}],[\"$\",\"i\",null,{\"className\":\"xs:block  md:hidden dark:color-#fff i-carbon-align-box-top-left\"}]]}],[\"$\",\"$L7\",null,{\"className\":\"mr-20px\",\"href\":\"/tags\",\"children\":[[\"$\",\"span\",null,{\"className\":\"xs:hidden md:block\",\"children\":\"标签\"}],[\"$\",\"i\",null,{\"className\":\"xs:block  md:hidden dark:color-#fff i-carbon-bookmark-add\"}]]}],[\"$\",\"$L7\",null,{\"className\":\"mr-20px\",\"href\":\"/about\",\"children\":[[\"$\",\"span\",null,{\"className\":\"xs:hidden md:block\",\"children\":\"关于\"}],[\"$\",\"i\",null,{\"className\":\"xs:block  md:hidden dark:color-#fff i-carbon-sprout\"}]]}]]}],[\"$\",\"$8\",null,{\"fallback\":null,\"children\":[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$La\",null,{}]}]}]]}]]}],[\"$\",\"main\",null,{\"className\":\"font-sans flex-auto\",\"children\":[\"$Lb\",\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}],[\"$\",\"footer\",null,{\"className\":\"dark:color-white text-center h-66px leading-[66px]\",\"children\":[\"© \",2023,\", Rain | Powered by Next.js\"]}],[\"$\",\"$8\",null,{\"fallback\":null,\"children\":[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$Lc\",null,{}]}]}]]}]}]}]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"id\":\"__next\",\"children\":[\"$\",\"div\",null,{\"id\":\"app\",\"className\":\"flex h-100% flex-col\",\"children\":[[\"$\",\"header\",null,{\"className\":\"flex justify-between  w-68% h-66px m-auto items-center xs:w-100% p-l-80px p-r-80px xs:p-l-20px xs:p-r-20px shrink-0\",\"children\":[[\"$\",\"$L7\",null,{\"className\":\"text-20px cursor-pointer font-bold font-mono dark:color-white hover:color-#1e90ff\",\"href\":\"/\",\"children\":[\"$\",\"span\",null,{\"children\":\"Rain's Blog\"}]}],[\"$\",\"nav\",null,{\"className\":\"flex items-center column-50px\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"text-right opacity-[0.6] text-[16px] dark:color-#e5e7eb flex\",\"children\":[[\"$\",\"$L7\",null,{\"className\":\"mr-20px\",\"href\":\"/post\",\"children\":[[\"$\",\"span\",null,{\"className\":\"xs:hidden md:block\",\"children\":\"文章\"}],[\"$\",\"i\",null,{\"className\":\"xs:block  md:hidden dark:color-#fff i-carbon-align-box-top-left\"}]]}],[\"$\",\"$L7\",null,{\"className\":\"mr-20px\",\"href\":\"/tags\",\"children\":[[\"$\",\"span\",null,{\"className\":\"xs:hidden md:block\",\"children\":\"标签\"}],[\"$\",\"i\",null,{\"className\":\"xs:block  md:hidden dark:color-#fff i-carbon-bookmark-add\"}]]}],[\"$\",\"$L7\",null,{\"className\":\"mr-20px\",\"href\":\"/about\",\"children\":[[\"$\",\"span\",null,{\"className\":\"xs:hidden md:block\",\"children\":\"关于\"}],[\"$\",\"i\",null,{\"className\":\"xs:block  md:hidden dark:color-#fff i-carbon-sprout\"}]]}]]}],[\"$\",\"$8\",null,{\"fallback\":null,\"children\":[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$La\",null,{}]}]}]]}]]}],[\"$\",\"main\",null,{\"className\":\"font-sans flex-auto\",\"children\":[\"$\",\"$Ld\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Ld\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Ld\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",[\"slug\",\"code-format.md\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Lf\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"code-format.md\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/004d055e2de33bc2.css\",\"precedence\":\"next\"}]]}],\"segment\":[\"slug\",\"code-format.md\",\"d\"]},\"styles\":[]}],\"segment\":\"post\"},\"styles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"dark:color-white text-center h-66px leading-[66px]\",\"children\":[\"© \",2023,\", Rain | Powered by Next.js\"]}],[\"$\",\"$8\",null,{\"fallback\":null,\"children\":[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$Lc\",null,{}]}]}]]}]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"f:\"$L10\"\nb:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],null,null,null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,null]\n"])</script><script>self.__next_f.push([1,"5:[[[\"$\",\"meta\",null,{\"charSet\":\"utf-8\"}],[\"$\",\"title\",null,{\"children\":\"聊聊代码格式化\"}],[\"$\",\"meta\",null,{\"name\":\"description\",\"content\":\"如果你想让两个程序员吵起来，就只需要问他们 tab 和 space 谁更好\"}],null,null,null,null,null,null,null,null,[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]],[],null]]\n"])</script><script>self.__next_f.push([1,"10:[\"$\",\"div\",null,{\"className\":\"prose w-60% m-auto m-b-50px xs:w-90% m-t-66px\",\"children\":[[\"$\",\"div\",null,{\"className\":\"m-b-30px\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"聊聊代码格式化\"}],[\"$\",\"p\",null,{\"className\":\"flex justify-between\",\"children\":[[\"$\",\"span\",null,{\"className\":\"color-gray\",\"children\":[\"Rain, \",\"Fri  Mar  24  2023\"]}],[\"$\",\"$L7\",null,{\"className\":\"cursor-pointer color-gray\",\"href\":\"/post\",\"children\":\"back\"}]]}]]}]}],[\"$\",\"article\",null,{\"className\":\"prose\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ch2\u003eTabs VS Spaces\u003c/h2\u003e\\n\u003cp\u003e首先，我想谈谈我关于使用 Tab 还是 Space 的考虑。我毫无疑问地支持使用 Tab。\u003c/p\u003e\\n\u003cp\u003e我的理由是，Tab 能够自由地控制在编辑器中显示的长度；\\n同时，显然不是所有人对于空格个数的偏好都一致。\\n既然如此，为什么不使用 Tab 缩进，然后将显示缩进宽度的选择权交给每个人呢？\\n这样，无论你更喜欢紧凑的代码布局，还是想要增大缩进来尽早发现你代码中的嵌套，都是被允许的。\u003c/p\u003e\\n\u003cp\u003e当然，不是所有软件都允许你动态的调整 Tab 的长度。\\n如果它被固定到你不喜欢的宽度，可能会引起你的不适。\\nSpace 则没有这个问题。\u003c/p\u003e\\n\u003ch2\u003ePrettier\u003c/h2\u003e\\n\u003cp\u003e\u003ca href=\\\"https://prettier.io\\\"\u003ePrettier\u003c/a\u003e 是 Node.js 生态中使用最多的代码格式化工具。\\n它可以统一你的代码风格，比如缩进、引号、分号等。\u003c/p\u003e\\n\u003cp\u003e以下是我所使用的全部有关 Prettier 的内容。\u003c/p\u003e\\n\u003ch3\u003e设置过程\u003c/h3\u003e\\n\u003cp\u003e安装为开发依赖\u003c/p\u003e\\n\u003cpre class=\\\"pre-dark\\\" style=\\\"background:#fafafa\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #61AFEF\\\"\u003eni\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #D19A66\\\"\u003e-D\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003eprettier\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cp\u003e在 \u003ccode\u003epackage.json\u003c/code\u003e 中添加格式化的脚本和配置。\u003c/p\u003e\\n\u003cpre class=\\\"pre-dark\\\" style=\\\"background:#fafafa\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e{\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;scripts\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e    \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;format\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e\u0026quot;prettier --write .\u0026quot;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  },\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;prettier\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e    \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;semi\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color: #D19A66\\\"\u003efalse\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cp\u003e按需创建 \u003ccode\u003e.prettierignore\u003c/code\u003e 文件，你可以以 \u003ccode\u003e.gitignore\u003c/code\u003e 为基础。\u003c/p\u003e\\n\u003cp\u003e安装 \u003ca href=\\\"https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode\\\"\u003ePrettier VSCode 插件\u003c/a\u003e，添加配置到 \u003ccode\u003e.vscode/settings.json\u003c/code\u003e。\\n由于已经配置好 ignore 的规则，我们可以直接设置它为默认格式化器，如有例外的文件类型再自行覆盖。\u003c/p\u003e\\n\u003cpre class=\\\"pre-dark\\\" style=\\\"background:#fafafa\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e{\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;editor.defaultFormatter\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e\u0026quot;esbenp.prettier-vscode\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;editor.formatOnSave\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color: #D19A66\\\"\u003etrue\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cp\u003e如此，当你保存文件时，prettier 就会自动帮你格式化代码。\u003c/p\u003e\\n\u003ch3\u003eEditorConfig\u003c/h3\u003e\\n\u003cp\u003e\u003ca href=\\\"https://editorconfig.org\\\"\u003eEditorConfig\u003c/a\u003e 是一份通用的编辑器配置规范，很多编辑器和工具都支持它的配置项。\\n取决于你自己，可以设置好一份 \u003ccode\u003e.editorconfig\u003c/code\u003e 文件，它的配置项会被 Prettier 识别。\\n安装 \u003ca href=\\\"https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig\\\"\u003eEditorConfig VSCode 插件\u003c/a\u003e 后，也能按配置调整 vscode 的工作区设置。\u003c/p\u003e\\n\u003cpre class=\\\"pre-dark\\\" style=\\\"background:#fafafa\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #61AFEF\\\"\u003e[*]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003echarset\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e utf-8\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003eend_of_line\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e lf\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003emax_line_length\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e 80\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003eindent_style\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e tab\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003einsert_final_newline\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e true\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003etrim_trailing_whitespace\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e true\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #61AFEF\\\"\u003e[*.{md,yml}]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003eindent_style\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e space\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #C678DD\\\"\u003eindent_size\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e \u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color: #98C379\\\"\u003e 2\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003cblockquote\u003e\\n\u003cp\u003e需要注意 windows 和其它系统的换行符不同，为 crlf。\u003c/p\u003e\\n\u003c/blockquote\u003e\\n\u003ch2\u003eQ\u0026amp;A\u003c/h2\u003e\\n\u003ch3\u003e为什么不使用 eslint 来检查代码风格？\u003c/h3\u003e\\n\u003col\u003e\\n\u003cli\u003e要达到 Prettier 的格式化效果，需要配置维护大量的 eslint 规则，且存在不易实现的效果。\\n\u003col\u003e\\n\u003cli\u003e对于 vue 项目，你可以尝试使用 \u003ccode\u003e@antfu/eslint-config\u003c/code\u003e\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003c/li\u003e\\n\u003cli\u003e代码风格无关代码正确性，eslint 会飘很多红。lint 这个词对于代码风格来说太严格了。\\n\u003col\u003e\\n\u003cli\u003e虽然可以在保存时自动修复，但我受不了。\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003cp\u003e另外，推荐不要结合 eslint 使用 Prettier，vscode 明明有 lint 和 format 各自对应的设置项。\u003c/p\u003e\\n\u003ch3\u003e为何不配置 Prettier 的配置项和插件？\u003c/h3\u003e\\n\u003col\u003e\\n\u003cli\u003e就默认的配置而言，去除分号后，代码已经足够美观\u003c/li\u003e\\n\u003cli\u003e就我折腾 Prettier 插件的体验来说，只要超过使用一个插件，就很大概率会出现插件冲突的问题\\n\u003col\u003e\\n\u003cli\u003e我尝试折腾过 \u003ccode\u003e@ianvs/prettier-plugin-sort-imports\u003c/code\u003e 插件来格式化 import 语句，但它无法处理全部的场景。\u003c/li\u003e\\n\u003cli\u003e我也用过 \u003ccode\u003eprettier-plugin-tailwindcss\u003c/code\u003e 来排序 tailwind 的 classname。 但是它和前者无法共同使用，还会和 \u003ccode\u003e@egoist/tailwindcss-icons\u003c/code\u003e 不相容。\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003c/li\u003e\\n\u003c/ol\u003e\\n\u003ch3\u003e如何格式化 import 语句？\u003c/h3\u003e\\n\u003cp\u003e推荐使用 vscode 的设置项，它能实现对 import 进行排序，去除未使用的 import 等功能。\u003c/p\u003e\\n\u003cpre class=\\\"pre-dark\\\" style=\\\"background:#fafafa\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e{\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;editor.codeActionsOnSave\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e    \u003c/span\u003e\u003cspan style=\\\"color: #E06C75\\\"\u003e\u0026quot;source.organizeImports\u0026quot;\u003c/span\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color: #D19A66\\\"\u003etrue\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e  }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color: #ABB2BF\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\\n\u003ch2\u003e总结\u003c/h2\u003e\\n\u003cp\u003e总之，人生苦短，我懒得弄了。\u003c/p\u003e\\n\u003cp\u003e遇到的问题有的有办法规避或者解决，但是需要花时间去排查，我对此感到疲惫。\\n所以，我不愿意再去追求完美的效果，可以手动处理这些场景。\\n对于 Prettier 本体来说，开箱即用的体验挺好的。\u003c/p\u003e\\n\u003ch2\u003e相关链接\u003c/h2\u003e\\n\u003col\u003e\\n\u003cli\u003e\u003ca href=\\\"https://antfu.me/posts/why-not-prettier\\\"\u003eWhy I don't use Prettier\u003c/a\u003e\u003c/li\u003e\\n\u003c/ol\u003e\\n\"}}]]}]\n"])</script></body></html>