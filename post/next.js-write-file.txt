1:HL["/_next/static/css/0ff8ba3f2ba3a44a.css",{"as":"style"}]
0:[[["",{"children":["post",{"children":[["slug","next.js-write-file","d"],{"children":["__PAGE__?{\"slug\":\"next.js-write-file\"}",{}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/0ff8ba3f2ba3a44a.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/a17f24b94ffe9322.css",{"as":"style"}]
5:I{"id":"8920","chunks":["920:static/chunks/920-2fb459665447a51a.js","605:static/chunks/app/post/[slug]/page-0497c96a9a306d09.js"],"name":"","async":false}
6:"$Sreact.suspense"
7:I{"id":"7069","chunks":["920:static/chunks/920-2fb459665447a51a.js","185:static/chunks/app/layout-9b9665c86b0d6757.js"],"name":"NoSSR","async":false}
8:I{"id":"5554","chunks":["920:static/chunks/920-2fb459665447a51a.js","185:static/chunks/app/layout-9b9665c86b0d6757.js"],"name":"","async":false}
9:I{"id":"4463","chunks":["272:static/chunks/webpack-f352d0d4b542e5f1.js","667:static/chunks/2443530c-824e93370d7398c3.js","488:static/chunks/488-e1ddd61bb847c097.js"],"name":"","async":false}
a:I{"id":"1010","chunks":["272:static/chunks/webpack-f352d0d4b542e5f1.js","667:static/chunks/2443530c-824e93370d7398c3.js","488:static/chunks/488-e1ddd61bb847c097.js"],"name":"","async":false}
c:I{"id":"2263","chunks":["920:static/chunks/920-2fb459665447a51a.js","185:static/chunks/app/layout-9b9665c86b0d6757.js"],"name":"","async":false}
2:[["$","html",null,{"lang":"en","children":[["$","link",null,{"rel":"rainc.io","href":"/favicon.ico"}],["$","body",null,{"children":["$","div",null,{"id":"__next","children":["$","div",null,{"id":"app","className":"flex h-100% flex-col","children":[["$","header",null,{"className":"flex justify-between w-68% h-66px m-auto items-center xs:w-100% p-l-80px p-r-80px xs:p-l-30px xs:p-r-30px shrink-0","children":[["$","$L5",null,{"className":"text-20px cursor-pointer font-bold font-mono dark:color-white ","href":"/","children":["$","span",null,{"children":"Rain's Blog"}]}],["$","nav",null,{"className":"flex items-center column-50px","children":[["$","nav",null,{"className":"text-right opacity-[0.6] text-[16px] dark:color-#e5e7eb flex","children":[["$","$L5",null,{"className":"mr-20px","href":"/post","children":[["$","span",null,{"className":"xs:hidden md:block","children":"博客"}],["$","i",null,{"className":"xs:block  md:hidden dark:color-#fff i-carbon-align-box-top-left"}]]}],["$","$L5",null,{"className":"mr-20px","href":"/moment","children":[["$","span",null,{"className":"xs:hidden md:block","children":"随笔"}],["$","i",null,{"className":"xs:block  md:hidden dark:color-#fff i-carbon-bookmark-add"}]]}],["$","$L5",null,{"className":"mr-20px","href":"/about","children":[["$","span",null,{"className":"xs:hidden md:block","children":"关于"}],["$","i",null,{"className":"xs:block  md:hidden dark:color-#fff i-carbon-sprout"}]]}]]}],["$","$6",null,{"fallback":null,"children":["$","$L7",null,{"children":["$","$L8",null,{}]}]}]]}]]}],["$","main",null,{"className":"font-sans flex-auto","children":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","post","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L9",null,{"parallelRouterKey":"children","segmentPath":["children","post","children",["slug","next.js-write-file","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$La",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Lb",null],"segment":"__PAGE__?{\"slug\":\"next.js-write-file\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/a17f24b94ffe9322.css","precedence":"next"}]]}],"segment":["slug","next.js-write-file","d"]},"styles":[]}],"segment":"post"},"styles":[]}]}],["$","footer",null,{"className":"dark:color-white text-center h-66px leading-[66px]","children":["© ",2023,", Rain | Powered by Next.js"]}],["$","$6",null,{"fallback":null,"children":["$","$L7",null,{"children":["$","$Lc",null,{}]}]}]]}]}]}]]}],null]
3:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"定制化 Next.js 打包"}],["$","meta",null,{"name":"description","content":"learn more thing"}],null,null,null,null,null,null,null,null,["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]],[],null]]
b:"$Ld"
d:["$","div",null,{"className":"prose w-60% m-auto m-b-50px xs:w-90% m-t-66px","children":[["$","div",null,{"className":"m-b-30px","children":["$","div",null,{"children":[["$","h1",null,{"children":"定制化 Next.js 打包"}],["$","p",null,{"className":"flex justify-between","children":[["$","span",null,{"className":"color-gray","children":["Rain, ","Sat  Jul  15  2023"]}],["$","$L5",null,{"className":"cursor-pointer color-gray","href":"/post","children":"back"}]]}]]}]}],["$","article",null,{"className":"prose","dangerouslySetInnerHTML":{"__html":"<h3>向输出目录添加附加文件</h3>\n<p>来到 <code>next.config.js</code>文件，通过 webpack 的能力直接项输出目录新增文件和写入内容。</p>\n<pre class=\"pre-dark\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">fs</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">require</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&#39;fs&#39;</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">path</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">require</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&#39;path&#39;</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">isExist</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">false</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">nextConfig</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">output</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #98C379\">&#39;export&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #61AFEF\">webpack</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75; font-style: italic\">config</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75; font-style: italic\">options</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">currentCommand</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">process</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">env</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">npm_lifecycle_event</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">currentCommand</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">==</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;build&#39;</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">outDir</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">path</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">join</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">__dirname</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;out&#39;</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #56B6C2\">!</span><span style=\"color: #E5C07B\">fs</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">existsSync</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">outDir</span><span style=\"color: #ABB2BF\">)) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">fs</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">mkdirSync</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">outDir</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">watcher</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">fs</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">watch</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">outDir</span><span style=\"color: #ABB2BF\">, (</span><span style=\"color: #E06C75; font-style: italic\">event</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75; font-style: italic\">__filename</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">=&gt;</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #56B6C2\">!</span><span style=\"color: #E06C75\">isExist</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">event</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">==</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;change&#39;</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">fileName</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;_config.text&#39;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">outPath</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">path</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">join</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">__dirname</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;/out/&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">fileName</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">content</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">`hello next.js`</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&#39;once is enough&#39;</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">fs</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">writeFileSync</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">outPath</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">content</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">isExist</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">true</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #E5C07B\">process</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">on</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&#39;exit&#39;</span><span style=\"color: #ABB2BF\">, () </span><span style=\"color: #C678DD\">=&gt;</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">watcher</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">close</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">return</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">config</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E5C07B\">module</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">exports</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">nextConfig</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span></code></pre>\n<p>需要注意的是 next.js 的默认行为是在每次静态文件构建时清空输出目录（默认为 out 目录）。这是为了确保构建结果的一致性和避免旧文件的残留。</p>\n<p>所以在新增文件的时机要正确，新增早了，最后也是会被清空，而是应该监听 out 目录开始有新增文件的时候增加我们的配置文件。</p>\n"}}]]}]
